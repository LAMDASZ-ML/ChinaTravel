# Travel Planning Challange @ AIC 2025

## æ¯”èµ›é˜¶æ®µ

### åˆèµ›
åˆèµ›æä¾›æ•°æ®é›†ä»…ä¾›å‚èµ›è€…åœ¨å‰æœŸè¿›è¡Œç®—æ³•éªŒè¯ä¸è°ƒè¯•ï¼Œé€‰æ‰‹æäº¤çš„ç®—æ³•ä¸æ–¹æ¡ˆç»“æœä¸è®¡å…¥æœ€ç»ˆæ€»åˆ†ã€‚

### å¤èµ›
å¤èµ›æä¾›æ–°çš„æ•°æ®é›†(æ ¼å¼å’Œåˆèµ›ä¿æŒä¸€è‡´), é€‰æ‰‹æäº¤çš„æ¨¡å‹ç”±æœºå™¨è¿›è¡Œè‡ªåŠ¨è¯„åˆ†ï¼Œå…¶å¾—åˆ†å°†è®¡å…¥å†³èµ›æ€»åˆ†ã€‚
å¤èµ›æˆªæ­¢å‰æäº¤ç®—æ³•è¿è¡Œç»“æœå’Œä»£ç ï¼Œèµ›äº‹æ–¹éªŒè¯ç®—æ³•è¿è¡Œç»“æœï¼Œæœºå™¨è¯„åˆ†ç»“æœå°†åœ¨æ¯”èµ›ç½‘ç«™ä¸Šå±•ç¤ºã€‚

### å†³èµ›
å†³èµ›ä»£ç ä¸å¯æ›´æ”¹ï¼Œå‚èµ›é€‰æ‰‹å®Œå–„æäº¤ç®—æ³•æŠ€æœ¯æŠ¥å‘Šï¼Œè¿›è¡Œç°åœºç­”è¾©ã€‚
å†³èµ›ç»¼åˆæˆç»©ç”±å®¢è§‚è¯„åˆ†å’Œä¸»è§‚è¯„åˆ†æ„æˆï¼Œæ¯”ä¾‹ä¸º70%å’Œ30%ã€‚
 - å®¢è§‚è¯„åˆ†ï¼šå¤èµ›é˜¶æ®µæäº¤ä»£ç åœ¨ç§æœ‰æ•°æ®é›†ä¸Šè¿›è¡Œè¯„æµ‹éªŒè¯çš„å¾—åˆ†ï¼›
 - ä¸»è§‚è¯„åˆ†ï¼šä¾æ®ç»è¿‡æ ‡å‡†åŒ–å¤„ç†åçš„ç­”è¾©å¾—åˆ†ã€‚ç­”è¾©è¯„ä»·å°†ç»¼åˆè€ƒå¯Ÿå‚èµ›è€…çš„ç­”è¾©è¡¨ç°ï¼Œä»¥åŠæ‰€æäº¤çš„æŠ€æœ¯æ–¹æ¡ˆå’Œä»£ç æ–‡æ¡£ã€‚

## è¯„ä¼°æŒ‡æ ‡

### ç¯å¢ƒçº¦æŸ
ç¯å¢ƒçº¦æŸè¯„ä»·äº†è¾“å‡ºè§„åˆ’æ–¹æ¡ˆä¸­çš„ä¿¡æ¯æ˜¯å¦ä¸æä¾›çš„æ²™ç›’ç¯å¢ƒä¿¡æ¯ä¸€è‡´ï¼Œåº¦é‡äº†è§„åˆ’æ–¹æ¡ˆçš„å¯è¡Œæ€§ã€‚
[ç¯å¢ƒçº¦æŸè¯´æ˜æ–‡æ¡£](../chinatravel/symbol_verification/readme.md)


$$EPR-micro = \frac{\sum_{p\in P}\sum_{\in Env} 1_{passed(c,p)}}{|P|*|Env|}$$


$$EPR-macro = \frac{\sum_{p\in P}\prod_{\in Env} 1_{passed(c,p)}}{|P|}$$

### æ¡ä»¶é€»è¾‘çº¦æŸ
æ¡ä»¶é€»è¾‘çº¦æŸè¯„ä»·äº†è¾“å‡ºè§„åˆ’æ–¹æ¡ˆä¸­åœ¨æ»¡è¶³ç¯å¢ƒçº¦æŸçš„å‰æä¸‹å¯¹ç”¨æˆ·ä¸ªæ€§åŒ–éœ€æ±‚çš„æ»¡è¶³ç¨‹åº¦ã€‚

$$C-LPR = \frac{\sum_{p \in P} 1_{passed(Env,p)}\cdot \sum_{c\in C_p} 1_{passed(c,p)}}{\sum_{p \in P}|P|}$$

Pæ˜¯è¾“å‡ºçš„è§„åˆ’æ–¹æ¡ˆé›†åˆï¼ŒC_p æ˜¯æ–¹æ¡ˆ p å¯¹åº”è¯¢é—®ä¸­çš„çº¦æŸéœ€æ±‚é›†åˆï¼Œpassed(c,p) è¡¨ç¤ºåœ¨pä¸­çº¦æŸcæ˜¯å¦è¢«æ»¡è¶³ã€‚

### ç¡¬çº¦æŸé€šè¿‡ç‡
ç¡¬çº¦æŸé€šè¿‡ç‡è¡¨è¾¾äº†è¾“å‡ºè§„åˆ’æ–¹æ¡ˆä¸­æ»¡è¶³æ‰€æœ‰ç¯å¢ƒçº¦æŸå’Œé€»è¾‘çº¦æŸçš„æ¯”ä¾‹ã€‚
$$FPR = \frac{\sum_{p \in P} 1_{passed(Env,p)}\cdot \prod_{c\in C_p} 1_{passed(c,p)}}{\sum_{p \in P}|P|}$$

### åå¥½è¯„ä¼°
TPC æ¯”èµ›ä¸­ï¼Œæˆ‘ä»¬æä¾›äº†ä¸‰ä¸ªæ—…è¡Œä¸­å¸¸è§çš„åå¥½æŒ‡æ ‡ï¼š

æ¯å¤©è®¿é—®çš„æ™¯ç‚¹æ•°é‡å°½å¯èƒ½å¤š, Daily Average Attractions Visited, DAVï¼Œæ•°å€¼å½’ä¸€åŒ–åˆ°[0.4]ä½œä¸ºåˆ†æ•°

$$DAV\text{-}score = (DAV - 0)/4 $$


å¹³å‡äº¤é€šæ—¶é—´å°½å¯èƒ½å°‘ï¼Œ Averaged Transportation Time, ATTï¼Œæ•°å€¼å½’ä¸€åˆ°[15,120] (åˆ†é’Ÿ)ä½œä¸ºåˆ†æ•°

$$ATT\text{-}score = \max(\min((120-ATT)/(120-15),1),0) $$


æ¯å¤©é¤é¥®æ¨èæ•°é‡å°½å¯èƒ½å¤š, Daily Dining Recommendations, DDRï¼Œæ•°å€¼å½’ä¸€åˆ°[0,3] ä½œä¸ºåˆ†æ•°

$$DDR\text{-}score = \min((DDR - 0)/(3-0),1) $$

### æœ€ç»ˆå¾—åˆ†

Overall Score = 10% * EPR-micro + 10% * EPR-macro + 25% * C-LPR + 40% * FPR + 5% DAV-Score + 5% ATT-Score + 5% DDR-Score


## ç¯å¢ƒé…ç½®
è¯·æ ¹æ®ChinaTravelä»£ç åº“è¯´æ˜è¿›è¡Œç¯å¢ƒé…ç½®
https://github.com/LAMDASZ-ML/ChinaTravel/tree/main


## æ•°æ®é…ç½®

æ•°æ®é›†å’Œæ•°æ®ç´¢å¼•ä¸‹è½½ï¼š


[![Dataset-Phase1](https://img.shields.io/badge/Dataset-Phase1-yellow)](https://box.nju.edu.cn/d/15226dffe3c14ffba983/)

å¯†ç ï¼šTPC@AIC2025


è¯·å°†æ•°æ®é›†è§£å‹åˆ°`chinatravel/data/`ç›®å½•ä¸‹ã€‚ä¾‹å¦‚ï¼š`chinatravel/data/tpc_aic_phase1/`
å°†æ•°æ®ç´¢å¼•æ”¾åˆ°`chinatravel/evaluation/`ç›®å½•ä¸‹ã€‚ä¾‹å¦‚ï¼š`chinatravel/evaluation/tpc_aic_phase1.txt`


## ğŸ› ï¸ ç®—æ³•å¼€å‘

### 1. æ™ºèƒ½ä½“ç®—æ³•å¼€å‘

æˆ‘ä»¬åœ¨`chinatravel/agent/tpc_agent/` æä¾›äº†ç‹¬ç«‹çš„ç®—æ³•å¼€å‘ç›®å½•ï¼Œä½ å¯ä»¥æŠŠç®—æ³•éœ€è¦çš„å†…å®¹éƒ½æ”¾åˆ°è¿™é‡Œã€‚


### 2. è¯­è¨€æ¨¡å‹è®­ç»ƒé€‚é…

æ”¯æŒæœ¬åœ°è¯­è¨€æ¨¡å‹åœ¨æ—…è¡Œè§„åˆ’çš„é€‚é…ï¼Œä½ å¯ä»¥åœ¨`chinatravel/agent/tpc_agent/tpc_llm.py` æ–‡ä»¶ä¸­çš„TPCLLMå®ä¾‹åŒ–ä½ çš„æœ¬åœ°æ¨¡å‹æ¨ç†ä»£ç ã€‚


```python
class TPCLLM(AbstractLLM):
    def __init__(self):
        super().__init__()
        # Initialization logic
        self.name = "TPCLLM"

    def _get_response(self, messages, one_line, json_mode):
        # Implement the response logic of the LLM
        response = "Your LLM response"
        if json_mode:
            # Handle JSON mode
            pass
        elif one_line:
            # Handle one - line mode
            response = response.split("\n")[0]
        return response
```

### 3. æœ¬åœ°ç®—æ³•è¿è¡Œ
å®Œæˆæ™ºèƒ½ä½“ç®—æ³•å¼€å‘åï¼Œä½ å¯ä»¥ä½¿ç”¨å®éªŒè„šæœ¬è¿è¡Œä½ çš„ä»£ç ã€‚


ä»»åŠ¡1ï¼šåŸºäºç¬¦å·éªŒè¯å™¨çš„æ—…è¡Œæ–¹æ¡ˆä¿®æ­£
æµ‹è¯•æµç¨‹ä¸­æä¾›å¯¹ç”¨æˆ·éœ€æ±‚çš„é¢†åŸŸç‰¹å®šè¯­è¨€æè¿°å’Œç¬¦å·éªŒè¯å™¨ï¼Œç”¨æˆ·åœ¨æµ‹è¯•æ—¶å¯ä»¥é€šè¿‡è¯¥éªŒè¯å™¨å¯¹æ–¹æ¡ˆè¿›è¡Œæ ¡éªŒï¼Œå®æ—¶ä¿®æ­£æ–¹æ¡ˆã€‚


```bash
python run_tpc.py --splits tpc_aic_phase1 --agent TPCAgent --llm TPCLLM --oracle_translation
```

è§„åˆ’ç»“æœä¼šä¿å­˜åœ¨ï¼š`results/TPCAgent_TPCLLM_oracletranslation` ç›®å½•ã€‚


ä»»åŠ¡2ï¼šå…¨æµç¨‹æ–¹æ¡ˆç”Ÿæˆ
æµ‹è¯•æµç¨‹ä¸­ï¼Œç”¨æˆ·éœ€è¦å®æ—¶ç†è§£ç”¨æˆ·è‡ªç„¶è¯­è¨€è¡¨è¾¾çš„çº¦æŸéœ€æ±‚ï¼Œå¹¶è‡ªåŠ¨åŒ–åœ°ç»™å‡ºæ»¡è¶³çº¦æŸéœ€æ±‚çš„æ—…è¡Œæ–¹æ¡ˆã€‚

```bash
python run_tpc.py --splits tpc_aic_phase1 --agent TPCAgent --llm TPCLLM
```


### 4. æœ¬åœ°ç»“æœè·å–

æœ¬åœ°è¯„ä¼°ä»£ç åœ¨`eval_tpc.py`æ–‡ä»¶ä¸­æä¾›ã€‚ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿è¡Œè¯„ä¼°ä»£ç ï¼š

ä»»åŠ¡1ï¼šåŸºäºç¬¦å·éªŒè¯å™¨çš„æ—…è¡Œæ–¹æ¡ˆä¿®æ­£
```bash
python eval_tpc.py --splits tpc_aic_phase1 --method TPCAgent_TPCLLM_oracle_translation
```

ä»»åŠ¡2ï¼šå…¨æµç¨‹æ–¹æ¡ˆç”Ÿæˆ
```bash
python eval_tpc.py --splits tpc_aic_phase1 --method TPCAgent_TPCLLM
```

### 5. ä»£ç å’Œç»“æœæäº¤

ä»£ç å‹ç¼©åŒ… XXX_code.zipï¼šè¯·å°†`chinatravel/agent/tpc_agent/`å‹ç¼©æäº¤ã€‚

ï¼ˆä»»åŠ¡1ï¼‰
ç»“æœå‹ç¼©åŒ… XXX_code.zipï¼šè¯·å°†`chinatravel/results/TPCAgent_TPCLLM_oracletranslation/`å‹ç¼©æäº¤ã€‚

ï¼ˆä»»åŠ¡2ï¼‰
ç»“æœå‹ç¼©åŒ… XXX_code.zipï¼šè¯·å°†`chinatravel/results/TPCAgent_TPCLLM/`å‹ç¼©æäº¤ã€‚